(this["webpackJsonpscoobie-doobie-effector"]=this["webpackJsonpscoobie-doobie-effector"]||[]).push([[0],{78:function(e,t,n){"use strict";n.r(t);var r=n(5),c=n(4),i=n.n(c),a=n(29),o=n.n(a),s=n(11),u=n(30),h=n.n(u),d=n(32),j=n(8),b=Object(c.createContext)([]),l=Object(c.createContext)((function(){})),x=function(){return Object(c.useContext)(b)},f=function(e){if(!e.current)return null;var t=e.current,n=t.getAbsoluteTransform().copy();n.invert();var r=t.getStage().getPointerPosition();return n.point(r)},g=function(e){var t=e.beginPos,n=e.endPos;return Object(r.jsx)(j.c,{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y,fill:"blue",stroke:"red",opacity:.2})},O=function(e){var t=e.layoutSize,n=Object(c.useContext)(l),i=Object(c.useState)({x:0,y:0}),a=Object(s.a)(i,2),o=a[0],u=a[1],h=Object(c.useState)(!1),b=Object(s.a)(h,2),x=b[0],O=b[1],v=Object(c.useRef)(null);return Object(r.jsx)(j.d,{className:"input-area",width:t.width,height:t.height,ref:v,onMouseDown:function(){u(f(v)||{x:0,y:0}),O(!0)},onMouseUp:function(){!function(){var e=f(v)||{x:0,y:0};n((function(t){return[].concat(Object(d.a)(t),[{key:t.length,srcX:e.x,srcY:e.y,srcWidth:o.x-e.x,srcHeight:o.y-e.y,showX:e.x,showY:e.y,showWidth:o.x-e.x,showHeight:o.y-e.y}])}))}(),O(!1)},children:Object(r.jsx)(j.b,{children:x?Object(r.jsx)(g,{beginPos:o,endPos:f(v)||{x:0,y:0}}):null})})},v=function(e){var t=e.currentFrame,n=x();return Object(r.jsx)(r.Fragment,{children:n.map((function(e){return Object(r.jsx)(j.a,{image:t,crop:{x:e.srcX,y:e.srcY,width:e.srcWidth,height:e.srcHeight},x:e.showX,y:e.showY,width:e.showWidth,height:e.showHeight,stroke:"black",strokeWidth:10,draggable:!0},e.key)}))})},y=function(e){var t=e.layoutSize,n=e.baseCanvas,c=x();return Object(r.jsx)(j.d,{className:"output-area",width:t.width,height:t.height,children:Object(r.jsx)(b.Provider,{value:c,children:Object(r.jsxs)(j.b,{children:[Object(r.jsx)(j.a,{image:n}),Object(r.jsx)(v,{currentFrame:n})]})})})},w=function(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t},m=n(33),p={width:1280,height:720,facingMode:"user"},S=Object(m.a)({},p),P=function(){var e=Object(c.useState)(w(S)),t=Object(s.a)(e,2),n=t[0],i=t[1],a=Object(c.useState)([]),o=Object(s.a)(a,2),u=o[0],d=o[1],j=Object(c.useRef)(null),x=Object(c.useRef)();return Object(c.useEffect)((function(){return x.current=setInterval((function(){return function(e){if(j.current&&j.current.video){var t=w(e).getContext("2d");if(t){t.drawImage(j.current.video,0,0);var n=t.getImageData(0,0,e.width,e.height);!function(e){for(var t=e.data.length/4,n=0;n<t;n++){var r=.299*e.data[4*n+0]+.587*e.data[4*n+1]+.114*e.data[4*n+2];e.data[4*n+0]=r,e.data[4*n+1]=r,e.data[4*n+2]=r}}(n),t.putImageData(n,0,0),i(t.canvas)}}}(S)}),1e3/60),function(){clearInterval(x.current)}}),[60]),Object(r.jsxs)("section",{id:"app",children:[Object(r.jsx)(h.a,{id:"camera",ref:j,audio:!1,videoConstraints:p,width:S.width,height:S.height,style:{position:"absolute"}}),Object(r.jsx)(l.Provider,{value:d,children:Object(r.jsx)(O,{layoutSize:S})}),Object(r.jsx)(b.Provider,{value:u,children:Object(r.jsx)(y,{layoutSize:S,baseCanvas:n})})]})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(P,{})}),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.57a19b4d.chunk.js.map